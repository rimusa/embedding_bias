# Basically what this does is run the attract repel script. You must give the name of a file in the attract-repel/config folder to be able to run this.

# These lines generate the lists of synonims and antonyms
#python xweat/generate_lists.py

# This line generates the config files
#python attract_repel/code/generate_cfg.py

# Choose between 1 2 6 7 8 9
test_embs=1

# Choose between "ft" "w2v"
embeddings="ft"

# This activates the environment with tensorflow
conda activate tf-gpu-cuda8

# These lines run the actual code
for mod in "more" "less" ; do
    config="test${test_embs}_${mod}_${embeddings}.cfg"
    config_path="./attract_repel/config/${config}"
    python ./attract_repel/code/attract-repel.py $config_path
done

# This activates the environment with gensim
conda activate gensim

# Transform the embeddings from glove format to word2vec format
path1="../data/embeddings/${embeddings}_t${test_embs}_"
path2="_embeddings.300."

for mod in "more" "less" ; do
    path="${path1}${mod}${path2}"
    python -m gensim.scripts.glove2word2vec --input ${path}txt --output ${path}vec
done


similarity_type="cosine"
language="es"

for mod in "more" "less" ; do
    for test_number in 1 2 6 7 8 9 ; do
        python xweat/weat.py \
            --test_number $test_number \
            --permutation_number 1000000 \
            --output_file ../results/${embeddings}_${test_embs}${mod}_test${test_number}_cased.res \
            --lower True \
            --use_glove False \
            --is_vec_format True \
            --lang $language \
            --embeddings \
            ../data/embeddings/${embeddings}_t${test_embs}_${mod}_embeddings.300.txt \
            --similarity_type $similarity_type |& tee ../results/${embeddings}_${test_embs}${mod}_test${test_number}_cased.out
    done
done

